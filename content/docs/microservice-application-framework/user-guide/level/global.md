+++
title = "全局层"
weight = 1
+++

# 全局层

全局层是系统的最高层次，用于管理整个系统的配置。组织是与项目有关的最高层次，而组织之间的统一管理无法在单一组织中完成，因此需要一个与层级高于组织层，这个层级就是全局层。在全局层的操作，自上而下作用于系统-组织-项目。

在全局层中，可进行角色管理、全局层角色分配、菜单配置等功能。因为服务、权限、角色、菜单都是可作用于所有组织而不只是单一组织，它们作用于整个系统。服务是平台所能提供的功能。权限是是否能使用这些功能，具有层级性。角色是一组特定权限的集合，因此它也具有层级性，不同层级的角色只能在不同层级可供选择。全局层的角色分配中，只能给用户分配全局层的角色。菜单是系统左侧菜单栏的配置和展示，具有层级性，不同层级的菜单栏是不同的。

![层级关系](../images/I_2.png)

**全局层的功能：**

- [服务](#1)
- [权限](#2)
- [角色](#3)
- [角色分配](#4)
- [菜单配置](#5)

**进入方式：**

选中顶部导航栏的【管理】选项，即可进入全局层

![全局层](../images/I_1.png)



<h2 id="1">服务</h2>

服务是具有某一特定业务功能聚合的功能块。

- **内容：**所有服务的列表
- **功能：**可根据搜索条件查询服务

![服务](../images/1_1.png)

### 1 搜索服务

- 不选择属性，根据输入值全局搜索
- 选择一个属性：ID、服务编码、服务名称、描述，输入相应属性值进行模糊搜索

<h2 id="2">权限</h2>

权限是是否能使用某一特定功能的许可。具有某个功能的权限，则说明可使用这个功能，否则，无法使用该功能。

- **内容：**所有权限的列表
- **功能：**
    - 可根据搜索条件查询权限
    - 根据角色层级（全局层/组织层/项目层）、服务、类型；或根据输入值进行搜索

![权限](../images/2_1.png)

### 1 搜索权限

- 先选择角色层级：全局层/组织层/项目层，进行层级过滤
- 然后根据输入值进行搜索；或通过选择服务/类型进行权限过滤

<h2 id="3">角色</h2>

角色是一组特定权限的集合。以便给用户分配权限时不用选中无数个权限，而是选角色即可，极大简化了权限分配的操作。权限具有层级性，所以角色也具有层级性。给一个角色分配全局层权限后，则不能分配组织层、项目层的权限，这个角色为全局层角色；给一个角色分配组织层/项目层权限后，则不能分配全局层权限，这个角色为组织层/项目层角色。


- **内容：**权限的集合
- **功能：**可创建、根据所选角色创建、删除、编辑、停用/启用、查看详情、根据搜索条件查询角色
![角色](../images/3_1.png)

### 1 创建角色

**必填项：**

- 角色名：角色创建成功并启用后，可在角色分配（与角色权限相对应的层级）的自定义角色中，根据角色名选择

- 角色编码：
    - 具有唯一性
    - 用于与Git Lab角色关联

- 权限：全局层与组织层/项目层不可共存，组织层与项目层权限可共存。选择权限时，如果对于功能所需的权限不清楚，可以使用导航栏右上角的调试功能来查看

![image.png](../images/3.1_1.png)


**选填项：**

- 角色标签：实现不同系统之间角色的映射
    - 角色标签选项是针对GItLab或其他平台的角色灵活变更
    - 角色标签的选项不是固定的，可根据对应的其他平台进行设置，角色标签代表的是与其他平台角色关联关系

- 是否可编辑：目前不可选，所有新建的角色都默认勾选可编辑

- 是否启用：勾选后，角色可以被应用到角色分配中

![创建角色](../images/3.1_2.png)



### 2 根据所选角色创建

- **操作：**勾选要被继承的角色后，选中【根据所选角色创建】
- **结果：**新建的角色将继承被选角色的权限

### 3 其他操作

- **删除：**如果为内置角色，不可删除；不为内置角色，可删除
- **详情：**可查看创建角色时的信息
- **编辑：**如果是从后台数据库导入的角色，则不可编辑；前端创建的角色默认都可编辑
- **启用/停用：**停用角色后，角色信息依然存在，但在分配角色时无该角色选项

<h2 id="4">角色分配（全局层）</h2>

因为角色是权限的集合，所以角色分配相当于权限分配，而且是多个特定权限的分配。因为权限具有层级性，所以角色具有层级性，因而角色分配具有层级性-全局层、组织层、项目层。在不同层级的角色分配中，只可给用户分配对应层级的角色。在全局层的角色分配中，只能给用户分配全局层的角色，分配后用户具有使用全局层服务的权限。

- **内容：**管理成员（类型：用户/服务）角色
- **功能：**可对成员分配、删除、更改、查看（按成员/角色）角色
- **备注：**所有用户创建后，在全局层都被赋予【用户服务平台使用者】这个角色

### 1 角色分配（全局层）可选角色
- 用户服务
    - 用户服务平台管理员：菜单管理、角色管理、用户管理（初始化导入）、角色分配（组织层）及除服务发布之外所有功能
    - 用户服务平台使用者：只能进入平台，无其他任何功能权限

- 用户管理
    - 用户管理服务平台管理员

- 系统
    - 框架服务平台使用者

- 微服务管理服务
    - 微服务管理服务管理员

- 自定义角色
    - 如：项目查看者

### 2 分配、更改角色

- **分配角色：**

    1. 点击【添加】

    ![分配角色](../images/5.2_1.png)

    1. 输入成员（用户：用户名），选择角色

    ![分配角色](../images/5.2_2.png)

- **更改角色分配：**
- 点击角色名，出现下图列表即可继续角色更改

![更改角色](../images/5.2_3.png)

- **注意：**

    - 对已存在在角色分配列表里的成员，若进行【添加】操作会报错（因为【添加】操作是对没有被分配过角色的成员进行的），而应在更新操作中进行角色的更改

![已被分配角色的成员无法进行添加操作](../images/5.2_4.png)

![已被分配角色的成员只能进行更改操作](../images/5.2_5.png)

### 3 其他操作

- **删除角色分配：**可删除角色分配列表中的数据

![删除角色分配](../images/5.3_1.png)

- **查看角色分配：**可按成员/角色方式查看

![角色分配查看方式](..SS/images/5.3_2.png)

- **搜索角色分配：**可根据搜索条件查找角色分配列表的数据项
    - 不选择属性，根据输入值进行全局搜素
    - 选择一个属性：类型（用户/服务）、成员、昵称，输入相应属性值进行模糊搜索


<h2 id="5">菜单配置</h2>

菜单配置用于配置系统界面左侧菜单栏。里面分【菜单配置】和【菜单展示】两个子界面。【菜单配置】用于存放系统中所有菜单项；【菜单展示】直接与系统左侧菜单栏的显示相关联，可取菜单配置中存放的菜单项展示，可调整展示顺序，保存后【菜单展示】里的菜单项及其顺序就是系统左侧菜单所展示的。

- **内容：**侧边栏/菜单栏
- **功能：**可创建、配置菜单栏 

![菜单配置](../images/4_1.png)

### 1 菜单配置

1. 层级选择
   
    - 通过选择层级，来查看、配置不同层级（全局层/组织层/项目层）的菜单栏

1. 勾选要添加到菜单栏的目录/菜单
1. 点击[将所选菜单项添加至菜单结构]
1. 在菜单展示页将出现刚刚添加的目录/菜单，可拖动进行位置顺序调节

![菜单配置流程](../images/4.1_1.png)

### 2 添加目录

**必填项：**

- 目录中文名称
- 目录英文名称
- 目录编码

**选填项：**

- 目录ICON（目录图标）
    
    1. 在搜索栏，输入图标名称进行搜索
    1. 鼠标悬停在图标上，显示图标全称
    1. 在添加栏，输入图标全称
    1. 点击添加按钮
    1. 弹出弹窗，点击确认

    ![添加目录图标流程](../images/4.2_1.png)

    1. 创建目录成功后，该目录在菜单配置页和菜单展示页底部
    1. 长按鼠标右键，可对该目录进行位置拖动

- **注：**
    1. 只有目录下有菜单时，该目录才在菜单栏显示；否则该目录在菜单栏不显示 
    1. 确认要更改在某一层级（全局/组织/项目）的菜单项后，不要忘记在【菜单展示】左下角点击**保存**，否则切换层级后，之前的更改操作无效

![添加目录后](../images/4.2_2.png)

### 3 其他操作

- **删除：**目录可删除，菜单不可删除
- **详情：**在菜单配置页可查看菜单详情（目录不可）
- **编辑：**在菜单展示页可编辑目录（菜单不可）

![其他操作](../images/4.3_1.png)
